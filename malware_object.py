class Malware:

    def __init__(self, name, pid=None):
        self.pid_list = []
        if pid is not None:
            self.pid_list.append(pid)
        self.name = name
        self.instruction_executed = []
        self.starting_instruction = []
        self.active_pid = []

    def get_active_pid(self):
        for i in range(len(self.active_pid)):
            if self.active_pid[i]:
                return i
        print 'ERROR get_active_pid active pid not found'
        return -1

    def set_active_pid(self, position):
        if position > len(self.active_pid):
            print 'ERROR set_active_pid position value too high'
            return -1
        self.active_pid[position] = True

    def deactivate_pid(self, position):
        if position > len(self.active_pid):
            print 'ERROR deactivate_pid position value too high'
            return -1
        self.active_pid[position] = False

    def is_pid_active(self, position):
        if position > len(self.active_pid):
            print 'ERROR is_pid_active position value too high'
            return -1
        return self.active_pid[position]

    def get_name(self):
        return self.name

    def get_pid_list(self):
        return self.pid_list

    def get_pid(self, position):
        if position > len(self.pid_list):
            print 'ERROR get_pid position value too high'
            return -1
        return self.pid_list[position]

    def get_instruction_executed(self, position):
        if position > len(self.instruction_executed):
            print "ERROR get_instruction_executed position value too high"
            return -1
        if position == len(self.instruction_executed):
            self.instruction_executed.append(0)
        return self.instruction_executed[position]

    def get_starting_instruction(self, position):
        if position > len(self.starting_instruction):
            print "ERROR get_starting_instruction position value too high"
            return -1
        if position == len(self.instruction_executed):
            self.starting_instruction.append(0)
        return self.starting_instruction[position]

    def add_pid(self, pid):
        if pid in self.pid_list:
            print 'ERROR add_pid pid already in the list'
            return -1
        else:
            self.pid_list.append(pid)
            self.active_pid.append(True)
            return 1

    def set_name(self, name):
        if self.name == '':
            self.name = name
            return 1
        else:
            print 'ERROR set_name malware name already set'
            return -1

    def get_pid_position(self, pid):
        if pid not in self.pid_list:
            print 'ERROR get_pid_position pid not in pid list'
            return -1
        else:
            return self.pid_list.index(pid)

    def update_starting_instruction(self, position, starting_instruction):
        if position > len(self.starting_instruction):
            print "ERROR add_starting_instruction position value too high"
            return -1
        if position == len(self.starting_instruction):
            self.starting_instruction.append(starting_instruction)
        else:
            self.starting_instruction[position] = starting_instruction
        return 1

    def add_instruction_executed(self, position, instruction_executed):
        if position > len(self.instruction_executed):
            print "ERROR add_instruction_executed position value too high"
            return -1
        if position == len(self.instruction_executed):
            self.instruction_executed.append(instruction_executed)
        else:
            self.instruction_executed[position] += instruction_executed
        return 1

    def __str__(self):
        result = '--- ' + self.name + ' --- \n'
        for i in range(len(self.pid_list)):
            result += str('pid: ' + str(self.pid_list[i])) + '\t last starting instruction: ' + \
                      str(self.get_starting_instruction(i)) + '\t instruction executed: ' + \
                      str(self.get_instruction_executed(i)) + '\n'
        return result

    __repr__ = __str__
